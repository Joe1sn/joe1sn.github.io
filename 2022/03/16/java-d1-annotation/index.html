<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Joe1sn's Cabinet | JavaWeb笔记-注解</title><meta name="description" content="&lt;p&gt;注释部分&lt;/p&gt;"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700"><link rel="stylesheet" href="/css/highlights/darkula.css"><link rel="stylesheet" href="/css/main.css"><link rel="search" type="application/opensearchdescription+xml" href="https://joe1sn.eu.org/atom.xml" title="Joe1sn's Cabinet"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Joe1sn's Cabinet" type="application/atom+xml">
</head><body><div class="container"><header class="main-header"><h1 class="main-header__title uplize"><a class="main-header__title__link" href="/">Joe1sn's Cabinet</a></h1><nav class="main-header__nav"><ul class="main-nav"><li class="main-nav__list"><a class="main-nav__list__link" href="/" target="_self">HOME</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/archives/" target="_self">ARCHIVE</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="https://github.com/Joe1sn" target="_blank">GITHUB</a></li></ul></nav></header><main class="container__wrapper"><article class="article post"><h3 class="article__title">JavaWeb笔记-注解</h3><div class="article__date metadata"><div class="post-info">2022/03/16</div></div><div class="article__tags metadata">Tags:
<a class="article__tags__link metadata" href="/tags/Java/">Java</a></div><div class="article__body"><p>注释部分</p>
<span id="more"></span>
<h2 id="注解"><a class="markdownIt-Anchor" href="#注解"></a> 注解</h2>
<p><strong>概念</strong>：说明程序。For计算机</p>
<blockquote>
<p><strong>从JDK1.5开始，Java增加对元数据的支持</strong>，也就是注解，注解与注释是有一定区别的，可以把注解理解为代码里的特殊标记，<strong>这些标记可以在编译，类加载，运行时被读取</strong>，并执行相应的处理。通过注解开发人员可以在不改变原有代码和逻辑的情况下在源代码中嵌入补充信息。</p>
</blockquote>
<blockquote>
<p>注释：用文字描述程序。For程序员</p>
</blockquote>
<p><img src="https://img.joe1sn.top/uploads/big/eddfbc89d08cbd1cf6c61e1a3bcd242f.jpg" alt="" /></p>
<h2 id="作用"><a class="markdownIt-Anchor" href="#作用"></a> 作用</h2>
<ol>
<li>
<p>编写文档：标识生成doc文档</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> LearnJunit.annotation;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解 java doc演示</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5 </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> joe1sn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnoDemo1</span> &#123;</span><br><span class="line">    <span class="comment">//计算两数之和</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>javadoc AnnoDemo1.java -encoding UTF-8 -charset UTF-8</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">正在加载源文件AnnoDemo1.java...</span><br><span class="line">正在构造 Javadoc 信息...</span><br><span class="line">标准 Doclet 版本 1.8.0_301</span><br><span class="line">正在构建所有程序包和类的树...</span><br><span class="line">正在生成.\AnnoDemo1.html...</span><br><span class="line">正在生成.\package-frame.html...</span><br><span class="line">正在生成.\package-summary.html...</span><br><span class="line">正在生成.\package-tree.html...</span><br><span class="line">正在生成.\constant-values.html...</span><br><span class="line">正在构建所有程序包和类的索引...</span><br><span class="line">正在生成.\overview-tree.html...</span><br><span class="line">正在生成.\index-all.html...</span><br><span class="line">正在生成.\deprecated-list.html...</span><br><span class="line">正在构建所有类的索引...</span><br><span class="line">正在生成.\allclasses-frame.html...</span><br><span class="line">正在生成.\allclasses-noframe.html...</span><br><span class="line">正在生成.\index.html...</span><br><span class="line">正在生成.\help-doc.html...</span><br></pre></td></tr></table></figure>
<p><img src="https://img.joe1sn.top/uploads/big/824030c0e01f1b9d908641eb1c531649.png" alt="image-20220317110445576" /></p>
</li>
<li>
<p>代码检查：代码分析（使用反射）</p>
<p>例子： <strong>@Override</strong></p>
<p>也可以自定义注解【使用反射】</p>
</li>
<li>
<p>让编译器实现基本的检查</p>
</li>
</ol>
<h2 id="jdk预定义注解"><a class="markdownIt-Anchor" href="#jdk预定义注解"></a> JDK预定义注解</h2>
<ol>
<li>
<p><strong>@Override</strong></p>
<p>编译检查，检查被标记方法是否是被父类覆写的方法</p>
<p><img src="https://img.joe1sn.top/uploads/big/d22da63fa06a2ff90c7fd341620b6694.png" alt="image-20220316205850409" /></p>
</li>
<li>
<p><strong>@Deprecated</strong></p>
<p>该注解内容已过时</p>
<p><img src="https://img.joe1sn.top/uploads/big/553ce0833380809c33a8c6367e51e9fe.png" alt="image-20220317111415161" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/692186f911683d1e667c555ea00aebeb.png" alt="image-20220317111514278" /></p>
</li>
<li>
<p><strong>@SuppressWarnings</strong></p>
<p>压制警告，需要传参，一般传递&quot;all&quot;压制所有警告</p>
<p><img src="https://img.joe1sn.top/uploads/big/33fb9bf43b067d9eafaf9c9f8fbc0f18.png" alt="image-20220317111629903" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/bd29498aa83737f8eb253b185c412e95.png" alt="" /></p>
</li>
</ol>
<p><strong>自定义注解及使用(解析)</strong></p>
<p><strong>格式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.SOURCE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Override &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">元注解</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> 注解名称&#123;</span><br><span class="line">    属性列表</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img.joe1sn.top/uploads/big/a0bfe62d40a309e36f5822ea1ddf0751.png" alt="image-20220317205535179" /></p>
<p><strong>本质</strong>：注解本质上就是一个接口，接口默认继承Annotation()</p>
<p><img src="https://img.joe1sn.top/uploads/big/dc07bb2fa1d18d4faae9377a7f74222c.png" alt="image-20220317205755742" /></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyAnno</span> <span class="keyword">extends</span> <span class="title class_">java</span>.lang.annotation.Annotation &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>属性</strong>：接口中可以定义的成员方法</p>
<ul>
<li>
<p>要求：</p>
<ol>
<li>
<p>属性返回类型</p>
<ul>
<li>基本数据类型</li>
<li>String</li>
<li>枚举</li>
<li>注解</li>
<li>以上类型数组</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">show1</span><span class="params">()</span>;</span><br><span class="line">    String <span class="title function_">show2</span><span class="params">()</span>;</span><br><span class="line">    Person <span class="title function_">per</span><span class="params">()</span>;   <span class="comment">//枚举</span></span><br><span class="line">    MyAnno2 <span class="title function_">anno2</span><span class="params">()</span>;<span class="comment">//注解</span></span><br><span class="line">    String[] strs();<span class="comment">//字符串数组</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>定义的属性在使用时需要给属性赋值</p>
<p>缺少赋值：</p>
<p><img src="https://img.joe1sn.top/uploads/big/5190e30a9f7de7721cae0b5e8ed8edb3.png" alt="image-20220317210750659" /></p>
<p>只留下show1进行赋值</p>
<p><img src="https://img.joe1sn.top/uploads/big/76ca396dd0a1f0648ff03f48ef821ec5.png" alt="image-20220317210854025" /></p>
<p>默认赋值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">age</span><span class="params">()</span>;</span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;Doe&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果只有一个属性需要赋值，如果属性名称是value，直接赋值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> LearnJunit.annotation;</span><br><span class="line"></span><br><span class="line"><span class="meta">@MyAnno(1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Worker</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>对于枚举、注解、字符串的注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MyAnno(age=1,</span></span><br><span class="line"><span class="meta">        per=Person.P1,</span></span><br><span class="line"><span class="meta">        anno2=@MyAnno2,</span></span><br><span class="line"><span class="meta">//        strs=&#123;&quot;1&quot;,&quot;a&quot;,&quot;v&quot;&#125;</span></span><br><span class="line"><span class="meta">        strs = &quot;abcdefg&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Worker</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<p><strong>元注解</strong>：用于描述注解的注解</p>
<ul>
<li>
<p>@Target：描述注解能够作用的位置</p>
<p>ElementType取值：</p>
<ul>
<li>TYPE：作用于类上</li>
<li>METHOD：作用于方法上</li>
<li>FIELD：作用于成员变量上</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//表示anno3注解只能作用于类上</span></span><br><span class="line"><span class="meta">@Target(value = &#123;</span></span><br><span class="line"><span class="meta">        ElementType.TYPE,</span></span><br><span class="line"><span class="meta">        ElementType.METHOD,</span></span><br><span class="line"><span class="meta">        ElementType.FIELD</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno3 &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>@Retention：描述注解能被保留的阶段</p>
<p>RetentionPolicy：判断在哪个阶段，使用该注解</p>
<ol>
<li>SOURCE</li>
<li>CLASS</li>
<li>RUNTIME（一般使用这个）：会保留到class字节码文件中，并被JVM读取到</li>
</ol>
</li>
<li>
<p>@Documented：描述注解是否被抽取到api文档中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MyAnno3</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Worker</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;John&quot;</span>;</span><br><span class="line">    <span class="meta">@MyAnno3</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>&#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> - <span class="doctag">@Target</span>：描述注解能够作用的位置</span></span><br><span class="line"><span class="comment"> - <span class="doctag">@Retention</span>：描述注解能被保留的阶段</span></span><br><span class="line"><span class="comment"> - <span class="doctag">@Documented</span>：描述注解是否被抽取到api文档中</span></span><br><span class="line"><span class="comment"> - <span class="doctag">@Inherited</span>：描述注解是否这子类继承</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">//表示anno3注解只能作用于类上</span></span><br><span class="line"><span class="meta">@Target(value = &#123;</span></span><br><span class="line"><span class="meta">        ElementType.TYPE,</span></span><br><span class="line"><span class="meta">        ElementType.METHOD,</span></span><br><span class="line"><span class="meta">        ElementType.FIELD</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno3 &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="https://img.joe1sn.top/uploads/big/55ec7742b3dfd3a6307eab6c0fbfeb65.png" alt="image-20220317213546637" style="zoom:50%;" />
<p>删除该注解后</p>
<p><img src="https://img.joe1sn.top/uploads/big/a5887fe0ae0e2f8ba715f092e921dbe5.png" alt="image-20220317213717359" /></p>
</li>
<li>
<p>@Inherited：描述注解是否被子类继承</p>
</li>
</ul>
<h2 id="解析注解"><a class="markdownIt-Anchor" href="#解析注解"></a> 解析注解</h2>
<p>将配置文件的工作交给注解完成</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 描述需要执行的类名和方法名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Pro &#123;</span><br><span class="line">    String <span class="title function_">className</span><span class="params">()</span>;</span><br><span class="line">    String <span class="title function_">method</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> LearnJunit.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> LearnJunit.reflect.ReflectDemo1;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">//假设框架类</span></span><br><span class="line"><span class="meta">@Pro(className = &quot;LearnJunit.annotation.Demo1&quot;,</span></span><br><span class="line"><span class="meta">        method = &quot;show&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectFramework</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//1.解析注解</span></span><br><span class="line">        <span class="comment">//  获取该类的字节码文件对象</span></span><br><span class="line">        Class&lt;ReflectFramework&gt; reflectFrameworkClass = ReflectFramework.class;</span><br><span class="line">        <span class="comment">//2.获得注解对象</span></span><br><span class="line">        <span class="comment">//  内存中生成了该注解接口的 子类实现对象</span></span><br><span class="line">        <span class="type">Pro</span> <span class="variable">an</span> <span class="operator">=</span> reflectFrameworkClass.getAnnotation(Pro.class);</span><br><span class="line">        <span class="comment">//3.调用注解对象中定义的抽象方法，获取返回值</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> an.className();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于步骤2，在 21行下个断点</p>
<p><img src="https://img.joe1sn.top/uploads/big/d35c50f49cf1c60cb715378fd3d6b3ad.png" alt="image-20220318104234263" /></p>
<p>这个时候注解相关的都还没有对应数据，但是获得了注解(<code>.getAnnotation</code>)对象后</p>
<p><img src="https://img.joe1sn.top/uploads/big/2772d124590eb9c47998ee09e53de0a2.png" alt="image-20220318104558428" /></p>
<p>不仅<code>reflectFrameworkClass</code>注解有了值，而且在内存中多出了一个<code>an</code>变量，而<code>an</code>就是我们注解的内容</p>
<p>最后加上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.反射获得类</span></span><br><span class="line"><span class="type">Class</span> <span class="variable">aClass</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line"><span class="comment">//5.获得类的方法</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">aMethod</span> <span class="operator">=</span> aClass.getMethod(methodName);</span><br><span class="line"><span class="comment">//6.调用方法</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">aObject</span> <span class="operator">=</span> aClass.newInstance();</span><br><span class="line">aMethod.invoke(aObject);</span><br></pre></td></tr></table></figure>
<p>就能使用注解中的类的对应方法了</p>
<p><img src="https://img.joe1sn.top/uploads/big/043e3d7d89bd90901e4b29981c43aed9.png" alt="image-20220318105703388" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/9ec7243bbbb505cc94160fd5b7748d06.png" alt="image-20220318105745302" /></p>
<h2 id="案例"><a class="markdownIt-Anchor" href="#案例"></a> 案例</h2>
<p>测试类</p>
<p><code>LearnJunit.annotation.demo.Calculator</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> LearnJunit.annotation.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">    <span class="meta">@check</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1 + 0 = &quot;</span> + (<span class="number">1</span> + <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@check</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sub</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1 - 0 = &quot;</span> + (<span class="number">1</span> - <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@check</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mul</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1 * 0 = &quot;</span> + (<span class="number">1</span> * <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@check</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">div</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1 / 0 = &quot;</span> + (<span class="number">1</span> / <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;always normal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试注解</p>
<p><code>LearnJunit.annotation.demo.check</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> LearnJunit.annotation.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> check &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试方法</p>
<p><code>LearnJunit.annotation.demo.testCheck</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> LearnJunit.annotation.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 简单测试框架</span></span><br><span class="line"><span class="comment"> * 挡住方法执行后，自动执行被检测的所有方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">testCheck</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1.创建被测试对象</span></span><br><span class="line">        <span class="type">Calculator</span> <span class="variable">calculator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Calculator</span>();</span><br><span class="line">        <span class="comment">//2.得到所有带注解的函数</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">e_num</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//出现异常的次数</span></span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">FileWriter</span>(<span class="string">&quot;bug.txt&quot;</span>));<span class="comment">//创建文件对象</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.1得到所有函数</span></span><br><span class="line">        Method[] methods = calculator.getClass().getMethods();</span><br><span class="line">        <span class="keyword">for</span> (Method method:methods)&#123;</span><br><span class="line">            <span class="comment">//2.2检测是否带注解</span></span><br><span class="line">            <span class="keyword">if</span>(method.isAnnotationPresent(check.class))&#123;</span><br><span class="line">                <span class="comment">//2.3若带注解则执行</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    method.invoke(calculator);</span><br><span class="line">                &#125; <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    <span class="comment">//2.3.1捕获异常</span></span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="comment">//2.3.2记录到文件</span></span><br><span class="line">                    e_num++;</span><br><span class="line">                    bw.write(<span class="string">&quot;+++++&quot;</span>+method.getName()+<span class="string">&quot; 方法异常&quot;</span>);</span><br><span class="line">                    bw.newLine();</span><br><span class="line">                    bw.write(<span class="string">&quot;异常名称&gt;&gt; &quot;</span>+e.getCause().getClass().getSimpleName());</span><br><span class="line">                    bw.newLine();</span><br><span class="line">                    bw.write(<span class="string">&quot;异常原因&gt;&gt;&quot;</span>+e.getCause().getMessage());</span><br><span class="line">                    bw.newLine();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        bw.write(<span class="string">&quot;本次测试一共出现 &quot;</span>+e_num+<span class="string">&quot; 次异常&quot;</span>);</span><br><span class="line">        bw.newLine();</span><br><span class="line">        bw.flush();</span><br><span class="line">        bw.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://img.joe1sn.top/uploads/big/f72d98876821e798e96b8728ff0bf827.png" alt="image-20220318161130327" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/18f70660cfbf601197e9f5a2c85fa2fc.png" alt="image-20220318161502996" /></p>
<h2 id="小结"><a class="markdownIt-Anchor" href="#小结"></a> 小结</h2>
<ol>
<li>大多数时候使用注解而不是自定义注解</li>
<li>注解给谁用：
<ul>
<li>编译器</li>
<li>解析程序（checkTest）</li>
</ul>
</li>
<li>注解不是程序的一部分（相当于C的编译参数，如预编译命令）</li>
</ol>
</div></article><section class="comments"><div id="disqus_thread"></div><script>var disqus_shortname = 'disqus';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></section><div class="pagination"><a class="pagination__link pagination__prev" href="/2022/03/18/java-d2-database/">prev_post</a><a class="pagination__link pagination__next" href="/2022/03/16/java-d1-Junit/">next_post</a></div></main><footer class="footer metadata"><p class="footer__text">© 2023 Joe1sn</p><p class="footer__text">Powered by <a class="footer__text__link" href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a class="footer__text__link" href="https://pages.github.com/" target="_blank">Github Page</a></p></footer></div></body></html>