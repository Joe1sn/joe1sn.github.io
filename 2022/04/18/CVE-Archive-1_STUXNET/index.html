<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Joe1sn's Cabinet | CVE-Archive STUXNET</title><meta name="description" content="&lt;h1 id=&quot;cve-archive-stuxnet&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#cve-archive-stuxnet&quot;&gt;&lt;/a&gt; CVE-Archive STUXNET&lt;/h1&gt;
&lt;h1 id=&quot;网安赛博编年史震网&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#网安赛博编年史震网&quot;&gt;&lt;/a&gt; 网安赛博编年史：震网&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;这个系列就是属于胡扯，受众自然不止网安行业相关者，希望各位路人吃到“好瓜”。系列中充满着各种“都市传说”，没有技术，只有吹逼，记录/胡扯重大网络安全漏洞背后有趣的相关事件。&lt;/p&gt;
&lt;/blockquote&gt;"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700"><link rel="stylesheet" href="/css/highlights/darkula.css"><link rel="stylesheet" href="/css/main.css"><link rel="search" type="application/opensearchdescription+xml" href="https://joe1sn.eu.org/atom.xml" title="Joe1sn's Cabinet"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Joe1sn's Cabinet" type="application/atom+xml">
</head><body><div class="container"><header class="main-header"><h1 class="main-header__title uplize"><a class="main-header__title__link" href="/">Joe1sn's Cabinet</a></h1><nav class="main-header__nav"><ul class="main-nav"><li class="main-nav__list"><a class="main-nav__list__link" href="/" target="_self">HOME</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="/archives/" target="_self">ARCHIVE</a></li><li class="main-nav__list"><a class="main-nav__list__link" href="https://github.com/Joe1sn" target="_blank">GITHUB</a></li></ul></nav></header><main class="container__wrapper"><article class="article post"><h3 class="article__title">CVE-Archive STUXNET</h3><div class="article__date metadata"><div class="post-info">2022/04/18</div></div><div class="article__tags metadata">Tags:
<a class="article__tags__link metadata" href="/tags/misc/">misc</a><a class="article__tags__link metadata" href="/tags/CVE/">CVE</a></div><div class="article__body"><h1 id="cve-archive-stuxnet"><a class="markdownIt-Anchor" href="#cve-archive-stuxnet"></a> CVE-Archive STUXNET</h1>
<h1 id="网安赛博编年史震网"><a class="markdownIt-Anchor" href="#网安赛博编年史震网"></a> 网安赛博编年史：震网</h1>
<blockquote>
<p>这个系列就是属于胡扯，受众自然不止网安行业相关者，希望各位路人吃到“好瓜”。系列中充满着各种“都市传说”，没有技术，只有吹逼，记录/胡扯重大网络安全漏洞背后有趣的相关事件。</p>
</blockquote>
<span id="more"></span>
<p><img src="https://img.joe1sn.top/uploads/big/eab9c6cd2118d9646d6bb5e0652e375b.png" alt="" /></p>
<h1 id="正式报告"><a class="markdownIt-Anchor" href="#正式报告"></a> 正式报告</h1>
<h2 id="what-is-stuxnet-什么是震网"><a class="markdownIt-Anchor" href="#what-is-stuxnet-什么是震网"></a> What Is Stuxnet? | 什么是震网</h2>
<blockquote>
<p>Stuxnet is a computer worm that was originally aimed at Iran’s nuclear facilities and has since mutated and spread to other industrial and energy-producing facilities. The original Stuxnet malware attack targeted the programmable logic controllers (PLCs) used to automate machine processes. It generated a flurry of media attention after it was discovered in 2010 because it was the first known virus to be capable of crippling hardware and because it appeared to have been created by the U.S. National Security Agency, the CIA, and Israeli intelligence.</p>
</blockquote>
<p>震网蠕虫最初始目标是伊朗的核设施突变过后攻击其他能源工业相关设施。原始的震网恶意软件攻击的是让机械自动化运行的PLC(可编程逻辑控制器)。自从2010被发现后，因为他是第一个有能力攻击硬件的病毒并且疑似由美国国安局、美国中央情报局和以色列情报局创造而被人们所了解。<br />
震网在攻击过程中使用了一系列的高级漏洞，并且加载了多个0day，攻击方式非常复杂。0day漏洞的解释：比如我现在使用的是最新版本的QQ，然后我发现了一个漏洞可以让我给你发送一张图片就控制你的电脑，但是我没有将这个漏洞公开或者上报，只有我一个人知道这个漏洞，自然没有安全软件能防止这个漏洞，因为其他人都不知道这个漏洞存在，那么这个漏洞就是0day，零日漏洞。</p>
<h2 id="cves-漏洞编号"><a class="markdownIt-Anchor" href="#cves-漏洞编号"></a> CVEs | 漏洞编号</h2>
<p>在对于伊朗的行动中，主要是以下两个漏洞</p>
<ol>
<li><strong>CVE-2010-2772</strong></li>
</ol>
<blockquote>
<p>Siemens Simatic WinCC and PCS 7 SCADA system uses a hard-coded password, which allows local users to access a back-end database and gain privileges, as demonstrated in the wild in July 2010 by the Stuxnet worm, a different vulnerability than CVE-2010-2568.</p>
</blockquote>
<p>编号：CVE-2010-2772</p>
<p>西门子Simatic WinCC和PCS 7 SCADA系统使用硬编码密码(例如<code>if password=='123456'</code>)导致本地用户访问后台数据库和提升权限，就像是2010年7月在野的震网病毒演示的一样，和CVE-2010-2568不同的漏洞</p>
<ol start="2">
<li><strong>CVE-2010-2568</strong></li>
</ol>
<blockquote>
<p>Windows Shell in Microsoft Windows XP SP3, Server 2003 SP2, Vista SP1 and SP2, Server 2008 SP2 and R2, and Windows 7 allows local users or remote attackers to execute arbitrary code via a crafted (1) .LNK or (2) .PIF shortcut file, which is not properly handled during icon display in Windows Explorer, as demonstrated in the wild in July 2010, and originally reported for malware that leverages CVE-2010-2772 in Siemens WinCC SCADA systems.</p>
</blockquote>
<p>编号：CVE-2010-2568</p>
<p>Windows系统中的XP SP3, Server 2003 SP2, Vista SP1 and SP2, Server 2008 SP2 and R2和Windows 7版本允许本地用户或者远程攻击者使用<code>.lnk</code>和<code>.pif</code>快捷方式文件来执行任意代码，源于windows资源管理器中显示图标期间未正确处理，就像是2010年7月在野的震网病毒演示的一样，最初是报告于在Siemens WinCC SCADA systems中存在的CVE-2010-2772</p>
<p><img src="https://img.joe1sn.top/uploads/big/897c50ba37854109541d0ad2e146db9b.gif" alt="" /></p>
<h1 id="背景"><a class="markdownIt-Anchor" href="#背景"></a> 背景</h1>
<h2 id="时间线"><a class="markdownIt-Anchor" href="#时间线"></a> 时间线</h2>
<p><strong>2010 年 / Stuxnet 震网病毒</strong></p>
<p>美国和以色列的网络部队打击伊朗核计划，试图放慢伊朗制造浓缩铀的进程。震网病毒可以说是世界上第一个数字武器，与之前的任何其他病毒或蠕虫都不同。它并不会劫持目标计算机或窃取信息，而是会摧毁浓缩铀的离心机。Stunext需要经过复杂的编程才能实现这个目的。 此外，Stuxnet 只能攻击特定的西门子工业控制系统和CPU，还必须确定这些系统在伊朗运作。但是，震网病毒真真切切让人们开始关注并思考互联网环境中工控安全的发展。</p>
<p>它的源代码非常罕见，现在基本只有针对他的样本逆向研究(当然，样本也十分罕见)，植入方式研究，和溯源工作(美国和以色列)</p>
<p>暗网的一些网站也可以时不时看到一些相关信息</p>
<p><img src="https://img.joe1sn.top/uploads/big/6743f300b42d637f989bb38a9b06737f.png" alt="image-20220418224409896" /></p>
<hr />
<p>故事始于20世纪70年代，从巴基斯坦核物理科学家阿卜杜勒·卡迪尔·可汗（Adbul·Qadeer·Khan）开始。</p>
<p><img src="https://img.joe1sn.top/uploads/big/a8229e60acfaa3e27e79eca5aea49c16.jpg" alt="Abdul Qadeer Khan.jpg" /></p>
<p>​	阿卜杜勒·卡迪尔·可汗，更为著名的称号是“巴基斯坦原子武器计划之父”。1936 年 4 月 1 日出生于博帕尔，该城市当时位于昔日的英属印度王子邦博帕尔州，现在是中央邦的首府。他的家人是说乌尔都语的普什图人。他的父亲Abdul Ghafoor是一名曾在教育部工作的教师，他的母亲Zulekha是一位非常虔诚的家庭主妇。他的哥哥姐姐和其他家庭成员在印度1947年血腥分治期间移居巴基斯坦（分离独立的巴基斯坦），他经常写信给可汗的父母，讲述他们在巴基斯坦找到的新生活。</p>
<p><img src="https://img.joe1sn.top/uploads/big/0dc27225fdf05afce46596149857a829.png" alt="image-20220419164014149" /></p>
<p>​	1952年，可汗从博帕尔的一所当地学校录取后，乘坐信德邮报火车从印度移民到巴基斯坦，部分原因是当时的保留政治。以及他年轻时印度的宗教暴力事件给他留下了深刻的印象，给他的世界观留下了不可磨灭的印象。与家人在卡拉奇定居后，可汗在转入卡拉奇大学之前短暂地就读于DJ科学学院，并于 1956年毕业于该大学，获得物理学学士学位(BSc)，专注于固态物理学。<br />
​	1956年至1959年，可汗受雇于卡拉奇市大都会公司（市政府）担任度量衡检查员，并申请奖学金，使他能够在西德学习。	1961年，Khan前往西德，在西柏林工业大学学习材料科学，在那里他在冶金课程方面成绩优异，但在转投德国代尔夫特工业大学时离开了西柏林。<br />
​	<strong>1962年</strong>，在海牙度假时，他遇到了 Henny——一位英国护照持有者，他出生在南非的荷兰侨民。她会说荷兰语，并在非洲度过了她的童年，然后与父母一起返回荷兰，在那里她以注册外国人的身份生活。1963 年，他在巴基斯坦驻海牙大使馆举行的一个温和的穆斯林仪式上与 Henny 结婚。可汗和亨尼共有两个女儿。<br />
​	1967年，Khan 获得了材料技术工程师学位 ——相当于巴基斯坦等英语国家提供的理学硕士(MS)学位——并加入了比利时鲁汶大学的冶金工程博士课程。他曾在比利时鲁汶大学教授 Martin J. Brabers指导过他的博士论文，Khan 成功通过答辩，并于 	1972年毕业于冶金工程专业。他的论文包括基础研究马氏体及其在石墨烯形态领域的扩展工业应用。<br />
​	<strong>1974年5月</strong>，在得知印度突然进行“微笑佛”核试验后，汗想为制造原子弹的努力做出贡献，并会见了巴基斯坦驻海牙大使馆的官员，后者劝阻他说“很难做到”。在 PAEC 找到一份“冶金学家”的工作。8 月，汗写了一封没有引起注意的信，但他在 9 月通过巴基斯坦大使将另一封信寄给了总理秘书处。</p>
<p><img src="https://img.joe1sn.top/uploads/big/f40f9e2cdaa44224e19467d3344c548e.png" alt="img" /></p>
<p>​	可汗不知道的是，自 1972年1月20日以来，他的国家的科学家们已经在研究原子弹的可行性，该计划由反应堆物理学家穆尼尔·艾哈迈德·汗 ( Munir Ahmad Khan ) 领导，该计划对他的“父亲”提出了质疑。宣称总理祖尔菲卡尔·阿里·布托（ Zulfikar Ali Bhutto ）在阅读了他的信后，让他的军事秘书对当时不为人知的可汗进行了安全检查，以进行核实，并要求PAEC派出一个在巴希鲁丁·马哈茂德（ Bashiruddin Mahmood ）领导下的小组汗在他位于阿尔梅洛的家中，并指示布托的信在伊斯兰堡与他会面。1974 年 12 月抵达后，汗乘坐出租车直奔总理府。他会见了布托总理，他解释了高浓缩铀的重要性，会议以布托的话结束：“他似乎有道理。”<br />
​	第二天，Khan 会见了 Munir Ahmad 和其他资深科学家，重点讨论了生产高浓缩铀(HEU) 以对抗武器级钚，并向布托解释了为什么他认为“钚”的想法行不通.后来，布托政府的几位官员建议可汗留在荷兰，以了解更多关于离心机技术的信息，但继续就马哈茂德领导的 706 项目浓缩计划提供咨询。同时可汗偷走了Urenco集团用于分离铀产物的西门子离心机和相关蓝图。到 1975年12月，当Urenco集团开始怀疑他与Mahmood进行不谨慎的公开会议以指导他了解离心机技术时，Khan被转移到一个不太敏感的部门。可汗开始担心他在荷兰的安全，最终坚持要回国。<br />
​	<strong>1996年</strong>，可汗开始把离心机（数千台）和蓝图，卖给伊朗和利比亚，支持他们各自的核武器计划。<br />
​	<strong>2000年</strong>，位于<strong>伊朗</strong>纳坦兹（Natanz)的核工厂破土动工，计划建造一座能够容纳50,000台旋转离心机以富集铀气的设施。同年，荷兰情报机构AIVD潜入伊朗某核心国防组织，获取了伊朗核计划相关情报。</p>
<p><img src="https://img.joe1sn.top/uploads/big/646c98d8443ec963dd6677cefb94fb7e.png" alt="image-20220419104448924" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/d6653b1f33d60b02c396e63d8608cfd8.jpg" alt="img" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/6aa9e9befc756c07234699b69778b7ed.jpg" alt="img" /></p>
<blockquote>
<p>On 14 August 2002, <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Alireza_Jafarzadeh">Alireza Jafarzadeh</a>, a spokesman for an Iranian dissident group <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/National_Council_of_Resistance_of_Iran">National Council of Resistance of Iran</a>, publicly revealed the existence of two nuclear sites under construction: a uranium enrichment facility in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Natanz">Natanz</a> (part of which is underground), and a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Heavy_water">heavy water</a> facility in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Arak,_Iran">Arak</a>. It has been strongly suggested that intelligence agencies already knew about these facilities but the reports had been classified.</p>
</blockquote>
<p>​	2002年，伊朗异见政治组织在华盛顿开发布会，组织伊朗全国抵抗委员会的发言人Alireza Jafarzadeh公开透露存在两个正在建设中的核设施：纳坦兹的一个铀浓缩设施（部分位于地下）和一个重型核设施：阿拉克的重水设施。 有人强烈建议情报机构重视这些设施，但报告已被保密。这引起联合国和西方国家重视。<br />
​	2003年，英美情报部门在联合行动中截获了一批（约数千）可汗卖往利比亚的离心机。这批离心机组件与在纳坦兹使用的型号相同。在谈判中，以放低对利比亚的制裁为条件，利比亚同意放弃核计划，同时退还所有已经收到的离心机。<br />
​	计划一直持续到2004 年 1 月，穆沙拉夫政府就美国布什政府交给他们的核扩散证据对可汗进行了汇报，该报告可能和之前政见反对者的秘密情报有关。 可汗被指控非法出售核机密，并于当年被软禁。经过多年的软禁，可汗成功地在伊斯兰堡高等法院对巴基斯坦联邦政府提起诉讼，该法院的判决宣布他的汇报违宪，并于 6 日将其释放。2009 年 2 月，在他于 2021 年 10 月 10 日去世后，巴基斯坦在费萨尔清真寺举行了国葬，然后被安葬在伊斯兰堡的 H-8 墓地。<br />
​	<strong>2004年</strong>，IAEA（国际原子能组织）试图进一步调查伊朗核计划，伊朗表面也同意放弃计划，但是仍在计划暗中筹划。 于是同年，在荷兰人的帮助下，美国获取了被扣押的利比亚离心机（同运往纳坦兹的是同一款），并运到位于田纳西州的橡树岭国家实验室进行分析，以确定伊朗需要多长时间才能充满足够的气体来制造核武器，<strong>而植入干扰和破坏离心机的网络武器的计划，也自此诞生</strong>。</p>
<p>橡树岭国家实验室：是美国能源部所属的一个大型多学科研究国家实验室，位于田纳西州橡树岭。此实验室成立于1943年，最初是作为曼哈顿计划的一部分，以生产和分离铀和钚为主要目的建造的，原称克林顿实验室。2000年4月以后由田纳西大学和巴特勒纪念研究所共同管理。</p>
<p><img src="https://img.joe1sn.top/uploads/medium/abaf52e9fe53f3e1773ccc1920a2c005.png" alt="橡树岭国家实验室在田纳西州的位置" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/4a3eedb2e51ab2ddcb13a995f788f213.png" alt="" /></p>
<p>2005年，伊朗撕毁核武器协议，继续开始核武器研制计划。</p>
<p><strong>2006年2月</strong>，第一批浓缩铀产物开始从纳坦兹的实验工厂产出。这一年，在伊朗“高歌猛进”核计划时，大洋的彼岸，用于攻击“核武器”的网络武器也已研制完毕，并在搭建的模拟环境中成功实现了攻击测试，乔治布什确认了成功后授权秘密行动，即“奥林匹克”行动。</p>
<p><img src="https://img.joe1sn.top/uploads/big/24bc6a235c804b4099f426f995fbed53.png" alt="img" /></p>
<p><strong>2007年2月</strong>，伊朗正式启动核计划，开始在纳坦兹安装离心机。当年5月，伊朗在纳坦兹安装了1,700台富含天然气的离心机，并计划在夏天前，再安装两倍的离心机。但就在2007年夏天之前，荷兰间谍已经成功潜入了。</p>
<p>事实上，有证据表明在此期间发生的Stuxnet代码有过更新。根据安全公司赛门铁克公司对震网病毒进行逆向分析发现，攻击者在2006年5月和2007年2月对代码进行了更新，并于2007年9月24日对代码进行了最后的修改，修改了完成攻击所需的关键功能，并在该日期编译了代码。编译代码就是启动它之前的最后阶段。此前代码的修改与更新也暗示了荷兰间谍在2007年提供的情报对此版本有所贡献。）</p>
<p>9月24日，第一批攻击的代码完成。该代码旨在关闭随机数量的离心机上的出口阀门，致使铀能进不能出，此举提升了离心机内部压力，损坏离心机，并浪费铀。</p>
<p>由于纳坦兹的离心机网络是隔离的，离心机工程师会用U盘拷代码进离心机网络，因此间谍要么是直接把U盘插到了离心机网络，要么是感染了工程师，接着让工程师带入感染后的代码。</p>
<p>2008年，震网成功影响了离心机。荷兰间谍再也没有回去过纳坦兹，这一年，恶意软件也被删除了。</p>
<p><img src="https://img.joe1sn.top/uploads/big/3cc9671b059489eef21eb7490c1e9d60.png" alt="image-20220419163048075" /></p>
<p><strong>2009年</strong>，美国不满足于当前的结果，决定改变策略并于当年6月，以及在2010年的3、4月再次推出新版本。新版本代码改进版的离心机破坏部分，随机地提高离心机转速到超出设计范围，再降低，试图进一步破坏离心机本身和萃取过程。 这一次可能由于他们失去了潜伏到纳坦兹的路径，选择了一个更容易被曝光的激进方案：散播无差别攻击传播的感染版本到五家纳坦兹的合作公司。8月，以色列设法通过马来西亚软件公司，使伊朗购入了夹带“震网”病毒的离心机控制软件。该软件运行几周后，“震网”病毒于2010年6月爆发。病毒控制并破坏伊朗核设施的离心机设备，使其运行失控、高温自毁，同时不断向主控机房监控系统回传“设备正常运转”的假指令。当伊朗核设备管理部门发现问题时，已有1000余台离心机因过热出现了永久性物理损坏，伊方不得不暂停浓缩铀进程。这一次行动失控了，攻击迅速蔓延到这五家公司的合作伙伴、客户，并最终导致安全公司发现了这一网络武器。</p>
<p><strong>2010年6月</strong>，震网病毒首次被安全专家检测出来，成为世界史上首个超级网络破坏性武器。事实上，震网病毒有很多个全球公认的“第一”——世界上第一款军用级网络攻击武器，世界上第一款针对工业控制系统的木马病毒，世界上第一款能够对现实世界产生破坏性影响的木马病毒。</p>
<p><strong>2012年</strong>，根据斯诺登泄露的情报，美国在2012签署法案说明对他国使用网络武器需要获得总统签字，而之前唯一有此待遇的是核武器</p>
<p><img src="https://img.joe1sn.top/uploads/big/1556b58b9aeb8951e183c3146377dc63.png" alt="image-20220419180137027" /></p>
<p><img src="https://img.joe1sn.top/uploads/big/5f3dacd85667278748758a3f9448f091.png" alt="image-20220419175752869" /></p>
<h2 id="间谍风云"><a class="markdownIt-Anchor" href="#间谍风云"></a> 间谍风云</h2>
<h3 id="奥林匹克行动"><a class="markdownIt-Anchor" href="#奥林匹克行动"></a> 奥林匹克行动</h3>
<p><img src="https://img.joe1sn.top/uploads/big/b44520584477609e36eb3d7d6d21c55e.png" alt="image-20220419165746809" /></p>
<p>​	美国：参与机构涉及国家情报局NSA、中央情报局CIA，承担提供网络武器制作；<br />
​	以色列：参与机构涉及摩萨德、国防部和电子情报国家小组，负责支持网络武器和伊朗情报；<br />
​	荷兰：参与机构涉及情报机构AIVD，荷兰人在“行动”中具有其独特的地位：不仅提供有关伊朗从欧洲采购非法核计划设备的活动的关键情报，还承担设置间谍公司、实际投递的“重要之职”；<br />
​	德国、法国：提供西门子公司生产的离心机相关的技术细节和知识。</p>
<p>​	在布什的第二个任期内，时任美国战略司令部司令的詹姆斯卡特赖特将军和其他情报官员向布什提供了可以作为进攻性网络武器的复杂代码。行动目的是：<strong>获得对纳坦兹工厂工业计算机控制的访问权……计算机代码将侵入控制离心机的专用计算机</strong>。与以色列SIGINT情报机构Unit 8200合作。以色列的参与对美国很重要，因为前者拥有“关于纳坦兹行动的深入情报，这对于使网络攻击成功至关重要”。此外，美国官员希望“劝阻以色列人不要对伊朗核设施进行先发制人的打击”。为防止常规打击，以色列必须深入参与奥运会行动。两国制造的计算机病毒一经公开就被 IT 界称为Stuxnet 。恶意软件暂时停止了纳坦兹 5,000 台离心机中的大约 1,000 台的旋转。</p>
<p>​	在后续的调查阶段引申出一个更加宏大的项目：<strong>Nitro Zeus</strong>，是资金充足的综合网络攻击计划的项目名称，该计划是在Stuxnet恶意软件活动及其后果之后作为缓解策略创建的。与Stuxnet在设计阶段后加载到系统中以影响其正常运行不同，Nitro Zeus 的目标是<strong>在系统用户不知道的设计阶段内置到系统中</strong>。此内置功能允许对系统用户进行更可靠和更有效的网络攻击。<br />
​	亚历克斯·吉布尼（Alex Gibney）为他的零日纪录片进行的研究和采访中提出了有关其存在的信息。提议的对伊朗主要系统的长期广泛渗透将破坏和降低网络攻击者所期望的通信、电网和其他重要系统。这将通过伊朗计算机网络中的电子植入物来实现。该项目被视为替代全面战争的一种途径。</p>
<h3 id="中国台湾窃取的认证"><a class="markdownIt-Anchor" href="#中国台湾窃取的认证"></a> 中国台湾：窃取的认证</h3>
<p>Stuxnet需要直接通向windows的内核底层，所以他用到了一个数字认证书，这个数字证书被用于底层程序例如驱动等被操作系统信任的关键部位，系统依赖于证书来选择是否相信该程序。证书一般存储与于几家特定的公司，这些公司都于windows的核心业务相关。比如前段时间nvidia源码泄露后，nvidia的数字证书就被用于在了恶意代码上，这会使得该病毒的执行不会被杀毒软件所察觉等。</p>
<img src="https://img.joe1sn.top/uploads/big/e7ce5d41db8d9ae6709e3aa573413b2b.jpg" alt="img" style="zoom:50%;" />
<p>Stuxnet的证书来源于<code>realtek</code>（瑞昱）公司，就是我们经常看到的蓝色小螃蟹。数字证书是被作为一项高度机密的物件保存着，一般意味着：门，很多门、认证卡、生物认证、多人开锁，可能存在于某个在秘密小房间的USB里面。所以被盗取的方式一定是通过物理渗透，就是间谍。比如一个伪装成清洁工的人，在一个平平无奇的晚上用收集到的数据打开然后盗取数字证书，听起来就像是电影一样，但是这是真实存在的</p>
<h3 id="伊朗中东不安的中东"><a class="markdownIt-Anchor" href="#伊朗中东不安的中东"></a> 伊朗中东：不安的中东</h3>
<p>​	1950年代，伊朗开始核能源开发，而当时美国与伊朗的巴勒维政府是盟友关系，伊朗在中东的作用可以有助以色列抵抗阿拉伯国家。同时尼克松政府建议巴基斯坦和伊朗联合起来修建在伊朗境内的核电站，美国非常积极的推进着伊朗的核计划。而伊朗也是只认为自己是中东波斯王朝的正统延续，是中东的安全维护者。</p>
<p><img src="https://img.joe1sn.top/uploads/big/6af3705234707da47c0bdb45e3c8ab92.png" alt="image-20220420105646420" /></p>
<p>​	1979年，伊朗爆发革命，巴勒维下台流亡。1980年，美伊断交，其后美国多次指责伊朗秘密发展核武器。美国在两伊战争后对伊朗进行经济及军事制裁。<br />
​	2003年初，伊朗宣布提炼出核电站燃料铀。12月18日，伊朗签署《不扩散核武器条约》附加议定书。自2003年伊朗宣布成功提炼出铀以来，联合国已通过四个制裁伊朗的决议，美欧还出台了制裁法案。联合国对伊朗制裁主要集中在禁止伊朗参与国外核领域的投资、运输和金融活动。美国则切断伊朗所有金融机构与美国银行体系的联系，包括对向伊朗能源、贸易公司和央行提供物质支持的机构的制裁。2003年6月19日，国际原子能机构发表国际原子能机构理事会主席关于伊朗核问题的“总结性声明”敦促伊朗：“迅速纠正总干事巴拉迪在其报告中提到的伊朗在执行与《不扩散核武器条约》有关的保障协定中存在的所有问题，立即和无条件地签署和执行保障协定的附加议定书<br />
​	期间的伊拉克战争，美军数周打下伊拉克也给伊朗警觉，或许这加强了伊朗拥核的决心，可以回顾下前文<strong>A.Q.Khan</strong>的主要活动，就能明白伊朗是怎样逐渐拥有核设施的。</p>
<p>这是一段非常复杂的历史，是同样复杂的中东历史的一部分，限于篇幅，从冷战到现在的中东危机都是大国博弈、宗教冲突等复杂矛盾的集合体。</p>
<h1 id="stuxnet-20-duqu"><a class="markdownIt-Anchor" href="#stuxnet-20-duqu"></a> Stuxnet 2.0 ：DuQu</h1>
<p>被发现于2015年，在2011年就有了行动轨迹，代码和Stuxnet 1.0相似，但更既复杂。同时使用了自创的编程语言来对抗杀毒软件、安全防护和防止逆向。同样的搭载了多个0day，其中主要有3个</p>
<p><strong>CVE-2015-2360</strong></p>
<p>微软 Windows Server 2003 SP2 and R2 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, and Windows RT Gold and 8.1中的windows内核驱动<code>win32k.sys</code>存在漏洞从而被权限提升或者造成内存紊乱</p>
<p><strong>CVE-2014-4148</strong></p>
<p>微软 Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, and Windows RT Gold and 8.1中的windows内核驱动<code>win32k.sys</code>能够通过构造恶意字体从而造成远程代码执行</p>
<p><strong>CVE-2014-6324</strong></p>
<p>微软操作系统的权限管理，尤其是<strong>域</strong>权限管理时使用KDC的认证体系进行管理的。该漏洞可以伪造票据(ticket)将滋生权限提升到域管理员权限</p>
<h1 id="影响"><a class="markdownIt-Anchor" href="#影响"></a> 影响</h1>
<p>这是世界上首个专门针对工业控制系统编写的破坏性病毒，它同时利用包括MS10-046、MS10-061、MS08-067等 7个最新漏洞进行攻击。这7个漏洞中，有5个是针对windows系统，2个是针对西门子SIMATIC WinCC系统。另外在关于微软的5个漏洞中。病毒肆虐将影响我国众多企业。该病毒通过伪装RealTek 与JMicron两大公司的数字签名，从而顺利绕过安全产品的检测。从编写手法上看，该病毒还有很大的改进余地，将来很可能出现同样原理的复杂病毒。</p>
<p>作为世界上首个网络“超级破坏性武器”，Stuxnet的计算机病毒已经感染了全球超过 45000个网络，伊朗遭到的攻击最为严重，60%的个人电脑感染了这种病毒。</p>
<p>在传统工业与信息技术的融合不断加深、传统工业体系的安全核心从物理安全向信息安全转移的趋势和背景下，此次Stuxnet蠕虫攻击事件尤为值得我们进一步思考。<br />
这是一次极为不同寻常的攻击，其具体体现是：</p>
<ul>
<li>而这次攻击极富目的性</li>
<li>完全针对行业专用软件</li>
<li>使用了多个全新的零日漏洞进行全方位攻击，这是传统攻击难以企及的</li>
<li>这次攻击通过恰当的漏洞顺利渗透到内部专用网络中，这也正是传统攻击的弱项；</li>
<li>从时间、技术、手段、目的、攻击行为等多方面来看，完全可以认为发起此次攻击的不是一般的攻击者或组织。</li>
<li>因此，这次攻击中所采用的多个新漏洞和传播手段，将在接下来很长一段时间内给新的攻击提供最直接的动力。而更大的影响是，事件中显露出来的攻击思路和攻击视野会带来长久的示范效应。它给攻击者、安全研究人员、企业管理者带来的更多是一种安全观念和安全意识上的冲击。</li>
</ul>
<h1 id="相关引用"><a class="markdownIt-Anchor" href="#相关引用"></a> 相关引用</h1>
<p>[What Is Stuxnet? McAfee]<a target="_blank" rel="noopener" href="https://www.mcafee.com/enterprise/en-us/security-awareness/ransomware/what-is-stuxnet.html">https://www.mcafee.com/enterprise/en-us/security-awareness/ransomware/what-is-stuxnet.html</a></p>
<p>[CVE公告]<a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2010-2772">https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2010-2772</a></p>
<p>[CVE公告]<a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2568">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2568</a></p>
<p>[境外]<a target="_blank" rel="noopener" href="https://www.imdb.com/title/tt5446858/?ref_=fn_al_tt_1">https://www.imdb.com/title/tt5446858/?ref_=fn_al_tt_1</a></p>
<p>[境外]<a target="_blank" rel="noopener" href="https://news.yahoo.com/revealed-how-a-secret-dutch-mole-aided-the-us-israeli-stuxnet-cyber-attack-on-iran-160026018.html">https://news.yahoo.com/revealed-how-a-secret-dutch-mole-aided-the-us-israeli-stuxnet-cyber-attack-on-iran-160026018.html</a></p>
<p>[wiki]<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Abdul_Qadeer_Khan">https://en.wikipedia.org/wiki/Abdul_Qadeer_Khan</a></p>
<p>[境外]<a target="_blank" rel="noopener" href="https://www.bloomberg.com/news/articles/2022-04-17/iran-confirms-centrifuge-workshop-moved-to-underground-site?cmpid=socialflow-twitter-business&amp;utm_medium=social&amp;utm_campaign=socialflow-organic&amp;utm_content=business&amp;utm_source=twitter">https://www.bloomberg.com/news/articles/2022-04-17/iran-confirms-centrifuge-workshop-moved-to-underground-site?cmpid=socialflow-twitter-business&amp;utm_medium=social&amp;utm_campaign=socialflow-organic&amp;utm_content=business&amp;utm_source=twitter</a></p>
<p>[境外]<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%A9%A1%E6%A0%91%E5%B2%AD%E5%9B%BD%E5%AE%B6%E5%AE%9E%E9%AA%8C%E5%AE%A4">https://zh.wikipedia.org/wiki/橡树岭国家实验室</a></p>
<p>[境外]<a target="_blank" rel="noopener" href="https://www.nbcnews.com/id/wbna47647550">https://www.nbcnews.com/id/wbna47647550</a></p>
<p>[IAEA报告]<a target="_blank" rel="noopener" href="https://www.iaea.org/sites/default/files/gov2008-38_ch.pdf">https://www.iaea.org/sites/default/files/gov2008-38_ch.pdf</a></p>
<p>[联合国]<a target="_blank" rel="noopener" href="https://daccess-ods.un.org/tmp/9078331.58969879.html">https://daccess-ods.un.org/tmp/9078331.58969879.html</a></p>
<p>[境外]<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Operation_Olympic_Games">https://en.wikipedia.org/wiki/Operation_Olympic_Games</a></p>
<p>[华沙大学]<a target="_blank" rel="noopener" href="https://securityanddefence.pl/pdf-121974-52879?filename=Operation%20_Olympic.pdf">https://securityanddefence.pl/pdf-121974-52879?filename=Operation _Olympic.pdf</a></p>
<p>[youtube]<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=MNvc3huaUh4">https://www.youtube.com/watch?v=MNvc3huaUh4</a></p>
<p>[wiki]<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Duqu_2.0">https://en.wikipedia.org/wiki/Duqu_2.0</a></p>
</div></article><section class="comments"><div id="disqus_thread"></div><script>var disqus_shortname = 'disqus';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></section><div class="pagination"><a class="pagination__link pagination__prev" href="/2022/04/26/CVE-Archive-2-WANNACRY/">prev_post</a></div></main><footer class="footer metadata"><p class="footer__text">© 2023 Joe1sn</p><p class="footer__text">Powered by <a class="footer__text__link" href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a class="footer__text__link" href="https://pages.github.com/" target="_blank">Github Page</a></p></footer></div></body></html>